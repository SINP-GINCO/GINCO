<script>
/**============================================
 * Scripts for field mapping form handling with Ajax.
 * @author Anna Mouget
 *=============================================*/

var $dstFormatSelectList = $('#ign_bundle_configurateurbundle_field_mapping_dst_format');
// When dst_format gets selected ...
$dstFormatSelectList.change(function() {
	// Simulate form data, but only include the selected dst_format value.
	var data = {};
	// Submit data via AJAX to the form's action path.
	data[$dstFormatSelectList.attr('name')] = $dstFormatSelectList.val();
	// Submit data via AJAX to the form's action path.
	var path = "{{ path('configurateur_file_mappings', { 'datasetId' : dataset.id, 'format': file.format }) }}";
	$.ajax({
		url: path,
		type: "post",
		data : data,
		success: function(html) {
			// Replace current dst_data field ...
			$('#ign_bundle_configurateurbundle_field_mapping_dst_data').replaceWith(
				// ... with the returned one from the AJAX response.
				$(html).find('#ign_bundle_configurateurbundle_field_mapping_dst_data')
			);
			// Position field now displays the appropriate positions.
		},
		error : function(resultat, statut, erreur){
			console.log(resultat);
			console.log(statut);
			console.log(erreur);
		}
	});
});
 </script>